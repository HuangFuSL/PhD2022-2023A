\documentclass{../notes}

\title{组合数学 HW03}

\newcommand{\Gx}[1]{G^{(#1)}(x)}

\begin{document}
    \maketitle

    \paragraph*{2.1} 设函数族$\Gx n$为形如\eqnref{eq:2.1.1}的函数

    \begin{equation}
        G^{(n)}(x) = \sum_{k=0}^\infty k^n x^k
        \label{eq:2.1.1}
    \end{equation}

    则母函数为$G(x) = \Gx 3$。错位相减，计算$G(x) - xG(x)$，得到

    \begin{derive}[G(x) - xG(x)]
        &= \sum_{n=0}^\infty n^3x^n- \sum_{n=1}^\infty n^3x^{n+1} \\
        &= \sum_{n=1}^\infty \left(n^3 - (n-1)^3\right)x^n \\
        &= \sum_{n=1}^\infty \left(3n^2 - 3n + 1\right)x^n \\
        &= 3\Gx 2 - 3\Gx 1 + \Gx 0 - 1
        \label{eq:2.1.2}
    \end{derive}

    \begin{enumerate}
        \item[$\Gx 0$：] 根据函数$f(x) = 1/(1-x)$的泰勒展开，可得$\Gx 0 = 1/(1-x)$。
        \item[$\Gx 1$：] 计算$\Gx 1 - x\Gx 1$，得到

        \begin{derive}[\Gx 1 - x\Gx 1]
            &= \sum_{n=0}^\infty nx^n- \sum_{n=1}^\infty nx^{n+1} \\
            &= \sum_{n=1}^\infty x^n \\
            &= \Gx 0 - 1 \\
            &= \frac{x}{1-x}
        \end{derive}

        因此，$\Gx 1 = \left(\Gx 0 - 1\right)/(1-x) = x/(1-x)^2$。

        \item[$\Gx 2$：] 计算$\Gx 2 - x\Gx 2$，得到

        \begin{derive}[\Gx 2]
            &= \sum_{n=0}^\infty n^2x^n- \sum_{n=1}^\infty n^2x^{n+1} \\
            &= \sum_{n=1}^\infty \left(n^2 - (n-1)^2\right)x^n \\
            &= \sum_{n=1}^\infty \left(2n - 1\right)x^n \\
            &= 2\Gx 1 - \Gx 0 + 1 \\
            &= \frac{x(1 + x)}{(1 - x)^2}
        \end{derive}

        因此，$\Gx 2 = \left\{[x(1 + x)]/[(1 - x)^2]\right\}/(1-x) = x(1+x)/(1-x)^3$。
    \end{enumerate}

    将$\Gx i, i=0,1,2$代入\eqnref{eq:2.1.2}，并设各项最简分式系数为$A, B, C, D$，得到

    \begin{derive}[\Gx 3]
        &= \left[\frac{3x(1+x)}{(1-x)^3} - \frac{3x}{(1-x)^2} + \frac{1}{1-x} - 1\middle] \right/ (1 - x) \\
        &= \frac{x^3 + 4x^2 + x}{(1-x)^4} \\
        &= \frac{A}{1 - x} + \frac{B}{(1-x)^2} + \frac{C}{(1-x)^3} + \frac{D}{(1-x)^4}
    \end{derive}

    得到线性方程组

    \begin{equation}
        \begin{bmatrix}
            -1 & 0 & 0 & 0 \\
            3 & 1 & 0 & 0 \\
            -3 & -2 & -1 & 0 \\
            1 & 1 & 1 & 1 \\
        \end{bmatrix}\begin{bmatrix}
            A \\ B \\ C \\ D
        \end{bmatrix} = \begin{bmatrix}
            1 \\ 4 \\ 1 \\ 0
        \end{bmatrix}
    \end{equation}

    解得$\begin{bmatrix}A & B & C & D\end{bmatrix}^\top = \begin{bmatrix} -1 & 7 & -12 & 6 \end{bmatrix}^\top$，即

    \begin{equation}
        G(x) = -\frac{1}{1-x} + \frac{7}{(1-x)^2} - \frac{12}{(1-x)^3} + \frac{6}{(1-x)^4}
    \end{equation}

    \paragraph*{2.2} 沿用\textbf{2.1}中$\Gx n$的定义：

    \begin{derive}[G(x)]
        &= \sum_{n=0}^\infty \binom{3+n}{3} x^n \\
        &= \sum_{n=0}^\infty \frac{(3+n)!}{3!n!} x^n \\
        &= \sum_{n=0}^\infty \frac{n^3 + 6n^2 + 11n + 6}{6}x^n \\
        &= \frac 16 \Gx 3 + \Gx 2 + \frac{11}{6}\Gx 1 + \Gx 0 \\
        &= \frac{x^3 + 4x^2 + x}{6(1-x)^4} + \frac{x(1+x)}{(1-x)^3} + \frac{11x}{6(1-x)^2} + \frac{1}{1-x} \\
        &= \frac{1}{(1-x)^4}
    \end{derive}

    \paragraph*{2.5} 已知Fibonacci数列的递推公式为$F_{n+1} = F_n + F_{n-1}$。对于$G_{n + 1} = F_{2n+2}$，有

    \begin{derive}[G_{n+1}]
        &= F_{2n+2} \\
        &= F_{2n + 1} + F_{2n} \\
        &= 2F_{2n} + F_{2n - 1} \\
        &= 2F_{2n} + \left(F_{2n} - F_{2n - 2}\right) \\
        &= 3G_{n} - G_{n-1}
        \label{eq:2.5.1}
    \end{derive}
    
    得证。设序列$G_n = $对应的母函数$G(x) = G_0 + G_1 x + \cdots + G_n x^n + \cdots$，根据式\eqnref{eq:2.5.1}，有

    \begin{equation}
        (1 - 3x + x^2)G(x) = G_0 + (G_1 - 3G_0)x = x
    \end{equation}

    将$G(x)$化简为最简分式，得到

    \begin{derive}[G(x)]
        &= \frac{x}{1-3x+x^2} \\
        &= \frac{x}{\left(\frac{3 + \sqrt 5}{2} - x\right)\left(\frac{3 - \sqrt 5}{2} - x\right)} \\
        &= \frac{\sqrt 5 + 1}{2x - \left(3 + \sqrt 5\right)} + \frac{1 - \sqrt 5}{2x - \left(3 - \sqrt 5\right)}
    \end{derive}

    \paragraph*{2.15}

    已知序列的母函数为$G(x) = \frac{1}{1 - x + x^2}$。则$a_0 = G(0) = 1, a_1 = G'(0) = 1$。且：

    \begin{equation}
        (x^2 - x + 1)G(x) - 1 = 0
    \end{equation}

    将$G(x)$展开为$\sum_{n=0}^\infty a_nx^n$的形式，则：

    \begin{equation}
        \begin{aligned}
            &(x^2 - x + 1)\sum_{n=0}^\infty a_nx^n - 1 = 0 \\
            \Rightarrow & \sum_{n=0}^\infty a_nx^n(x^2 - x + 1) \\
            \Rightarrow & \sum_{n=2}^\infty (a_n - a_{n-1} + a_{n-2})x^n + (a_0 - a_1)x + a_0 - 1 = 0 \\
            \Rightarrow & \sum_{n=2}^\infty (a_n - a_{n-1} + a_{n-2})x^n = 0 \\
            \Rightarrow & a_n - a_{n-1} + a_{n-2} = 0 \\
            \Rightarrow & a_n = a_{n-1} - a_{n-2}
        \end{aligned}
    \end{equation}

    \paragraph*{2.22} 已知$a_n = 3^nc + (-1)^nd$，则$a_0 = c+d, a_1 = 3c-d$。设序列$\left\{a_n\right\}$对应的母函数为$G(x) = \sum_{n=0}^\infty \left(3^nc + (-1)^nd\right)x^n$，则

    \begin{derive}[G(x) + xG(x)]
        &= \sum_{n=0}^\infty \left(3^nc + (-1)^nd\right)x^n + \sum_{n=1}^\infty \left(3^{n-1}c + (-1)^{n-1}d\right)x^n \\
        &= (c + d) + 4c\sum_{n=1}^\infty (3x)^n \\
        &= (c + d) + \frac{4cx}{1 - 3x} \\
        G(x) &= \frac{(c+d)(1-3x) + 4cx}{(1-3x)(1+x)} \\
        &= \frac{(c+d) + (c-3d)x}{(1-3x)(1+x)} \\
        (-3x^2 - 2x + 1)G(x) &= (c + d) + (c - 3d)x \\
    \end{derive}

    从而$a_n$满足的递推关系为
    
    \begin{equation}
        a_n = 2a_{n-1} + 3a_{n-2}
    \end{equation}

    \paragraph*{2.49} 设符合题意的排列数目为$a_n$，根据题意，有$a_0 = 0, a_1 = 0, a_2 = 1$，首先求$a_n$满足的递推关系：

    将$n$个A,B,C,D组成的序列划分为前$n-1$个元素组成的序列和最后一个元素，若一个序列满足AB出现至少一次，则可以分为两种情况：

    \begin{enumerate}
        \item AB已经在前$n-1$个元素组成的序列中出现至少一次
        \item 前$n-2$个元素中没有AB出现，且序列由AB结尾
    \end{enumerate}

    由此，可以写出$a_n$满足的递推关系为：

    \begin{equation}
        \begin{aligned}
            & a_n = 4a_{n-1} + 4^{n-2} - a_{n-2} \\
            \Rightarrow & a_n - 4a_{n-1} + a_{n-2} = 4^{n-2}
        \end{aligned}
    \end{equation}

    设该递推关系对应的母函数为$G(x)$，由递推关系，可得

    \begin{derive}[(1 - 4x + x^2)G(x)]
        &= a_0 + (a_1 - 4a_0)x + \sum_{n=2}^\infty 4^{n-2}x^n \\
        &= \sum_{n=2}^\infty 4^{n-2}x^n \\
        &= \frac{x^2}{(1-4x)}
    \end{derive}

    因此，$G(x)$为

    \begin{equation}
        G(x) = \frac{x^2}{(1-4x)(x^2 - 4x + 1)}
    \end{equation}

    解方程$x^2 - 4x + 1 = 0$，解得$x = 2 \pm \sqrt 3$，因此$G(x)$可写作：

    \begin{equation}
        G(x) = \frac{A}{1-4x} + \frac{B}{(2 + \sqrt 3) - x} + \frac{C}{(2 - \sqrt 3) - x} \\
    \end{equation}

    式中$A, B, C$为常数，得到线性方程组

    \begin{equation}
        \begin{bmatrix}
            1 & 4 & 4\\
            -4 & 4\sqrt 3 - 9 & -\left(4\sqrt 3 + 9\right)\\
            1 & 2-\sqrt 3 & 2 + \sqrt 3
        \end{bmatrix} \begin{bmatrix}
            A \\ B \\ C
        \end{bmatrix} = \begin{bmatrix}
            1 \\ 0 \\ 0
        \end{bmatrix}
    \end{equation}

    解得$A = 1, B = \sqrt 3 / 6, C = -\sqrt 3 / 6$，因此

    \begin{derive}[G(x)]
        &= \frac{1}{1 - 4x} + \frac{2\sqrt 3 - 3}{6\left(1 - \frac{x}{2 + \sqrt 3}\right)} + \frac{2\sqrt 3 + 3}{6\left(1 - \frac{x}{2 - \sqrt 3}\right)} \\
        &= \sum_{n=0}^\infty \left(4x\right)^n + \frac{2\sqrt 3 - 3}{6}\sum_{n=0}^\infty \left[\left(2 - \sqrt 3\right)x\right]^n + \frac{2\sqrt 3 + 3}{6}\sum_{n=0}^\infty \left[\left(2 + \sqrt 3\right)x\right]^n
    \end{derive}

    因此，$a_n$的通项公式为

    \begin{equation}
        a_n = 4^n + \frac{2\sqrt 3 - 3}{6} \left(2 + \sqrt 3\right)^n + \frac{2\sqrt 3 + 3}{6} \left(2 - \sqrt 3\right)^n
    \end{equation}

    \paragraph*{2.63} 设$n$位二进制数中相邻两位不出现$11$的数的个数为$a_0$，则有$a_0 = 0, a_1 = 2, a_2 = 3$。首先求$a_n$满足的递推关系。

    将$n$位二进制数划分为前$n-1$个元素组成的序列和最后一个元素，若一个序列满足相邻两位不出现$11$，则

    \begin{enumerate}
        \item 若前$n-1$个元素以$0$结尾，则第$n$个元素既可以为$0$，也可以为$1$
        \item 若前$n-1$个元素以$1$结尾，则第$n$个元素只能为$0$
    \end{enumerate}

    设序列$\alpha_n, \beta_n, n\geq 2$分别表示相邻两位不出现$11$，且最后一位分别为$1, 0$的二进制数的个数，则$a_n = \alpha_n + \beta_n$。$\alpha_n, \beta_n$满足如下的递推关系

    \begin{equation}
        \left\{
        \begin{aligned}
            \alpha_n &= \beta_{n-1} \\
            \beta_n &= \alpha_{n-1} + \beta_{n-1} \\
            \alpha_1 &= \beta_1 = 1
        \end{aligned}
        \right .
    \end{equation}

    由此$\beta_{n} = \beta_{n-1} + \beta_{n-2}$，且$\beta_{1} = 1, \beta_1 = 2$。则$\beta_{n} = F_{n+1}$，其中$F_n$为Fibonacci数列（$F_{1} = F_2 = 1$）的第$n$项。$\alpha_n = \beta_{n-1} = F_{n}$，从而$a_n = F_{n} + F_{n+1} = F_{n+2}$。设序列$F_n$的母函数为$G(x)$，则$G(x)$满足

    \begin{derive}[G(x)]
        &= \frac{F_0 + (F_1 - F_0)x}{(1 - x - x^2)} \\
        &= \frac{x}{1 - x - x^2} \\
        &= \frac{A}{\frac{1 + \sqrt 5}{2} - x} + \frac{B}{\frac{1 - \sqrt 5}{2} - x} \\
        &= \frac{1}{\sqrt 5}\frac{1}{1 - x\left/\frac{1 + \sqrt 5}{2}\right.} - \frac{1}{\sqrt 5}\frac{1}{1 - x\left/\frac{1 - \sqrt 5}{2}\right.}
    \end{derive}

    因此$F_{n} = \frac{1}{\sqrt 5} \left[\left(\frac{1 + \sqrt 5}{2}\right)^n - \left(\frac{1 - \sqrt 5}{2}\right)^n\right]$，从而

    \begin{equation}
        a_{n} = F_{n+2} =\frac{1}{\sqrt 5} \left[\left(\frac{1 + \sqrt 5}{2}\right)^{n+2} - \left(\frac{1 - \sqrt 5}{2}\right)^{n+2}\right]
    \end{equation}

    \paragraph*{2.64} 设满足题意的序列数量为$a_n$，将序列划分为前$n-1$个元素组成的序列$S_{n-1}$和最后一个元素$s_n$，考虑前$n-1$个元素组成的序列$S_{n-1}$：

    \begin{enumerate}
        \item 当$S_{n-1}$的最后两个元素相同时，则$s_n$不能与该元素相同，共有$k-1$种情况，此时构造的序列最后两个元素不可能相同；
        \item 当$S_{n-1}$的最后两个元素不同时，$s_n$可以任意选择，共有$k$种情况。
    \end{enumerate}

    设序列$\alpha_n$表示满足题意且序列的最后两个元素相同的序列数量，$\beta_n$表示满足题意且序列的最后两个元素不同的序列数量。则有$a_n = \alpha_n + \beta_n$。$\alpha_n, \beta_n$满足如下的递推关系：

    \begin{equation}
        \left\{
        \begin{aligned}
            \alpha_n &= \beta_{n-1}\\
            \beta_0 &= \alpha_1 = 0 \\
            \beta_n &= (k-1)(\beta_{n-1} + \alpha_{n-1})\\
            \beta_1 &= k
        \end{aligned}
        \right.
    \end{equation}

    则$\beta_n = (k - 1)\beta_{n-1} + (k-1)\beta_{n-2}$。设$\beta_n$对应的母函数为$\Gx k$，则$\Gx k$满足如下的递推关系

    \begin{equation}
        \left[1 - (k-1)x - (k-1)x^2\right]\Gx k = \beta_0 + (\beta_1 + (k-1)\beta_0) x = kx
    \end{equation}

    从而，$\Gx k$可以写作

    \begin{derive}[\Gx k]
        &= \frac{kx}{1 - (k-1)x - (k-1)x^2} \\
        &= \frac{A}{1 - x\left/\frac{k-1 + \sqrt{(k-1)^2 + 4(k-1)}}{2}\right.} + \frac{B}{1 - x\left/\frac{k-1 - \sqrt{(k-1)^2 + 4(k-1)}}{2}\right.} \\
    \end{derive}

    设$a = (k - 1) / 2, b = \sqrt{(k-1)^2 + 4(k-1)} / 2$，解得$A = -k/2b, B = k/2b$，代入$\Gx k$，有

    \begin{equation}
        \Gx k = -\frac{k}{2b} \frac{1}{1 - x / (a + b)} + \frac{k}{2b}\frac{1}{1 - x / (a - b)}
    \end{equation}

    因此，$a_n$为

    \begin{derive}[a_n]
        &= \alpha_n + \beta_n
        &= \frac{k}{2b}\left((a+b)^n - (a-b)^n + (a+b)^{n-1} - (a-b)^{n-1}\right)
    \end{derive}

    式中，$a = (k - 1) / 2, b = \sqrt{(k-1)^2 + 4(k-1)} / 2$

    \paragraph*{2.65} 设函数族$\Gx k = \sum_{i=1}^x i^k$。已知$(i + 1)^5 = i^5 + 5i^4 + 10i^3 + 10i^2 + 5i + 1$，则

    \begin{derive}[(x + 1)^5]
        &= \sum_{i=0}^{x+1} \left[(i+1)^5 - i^5\right] \\
        &= 5\Gx 4 + 10\Gx 3 + 10\Gx 2 + 5\Gx 1 + 1
    \end{derive}

    因此$\Gx 4 = \left((x+1)^5 - 10\Gx 3 - 10\Gx 2 - 5\Gx 1 - 1\right) / 5$

    同理，有

    \begin{equation}
        \begin{aligned}
            \Gx 3 &= \left((x+1)^4 - 6\Gx 2 - 4\Gx 1 - 1\right) / 4 \\
            \Gx 2 &= \left((x+1)^3 - 3\Gx 1 - 1\right) / 3 \\
            \Gx 1 &= ((x+1)^2 - 1) / 2
        \end{aligned}
    \end{equation}

    由此，得

    \begin{equation}
        \begin{aligned}
            \Gx 1 &= \frac{x(x+1)}{2} \\
            \Gx 2 &= \frac{x(1+x)(1+2x)}{6} \\
            \Gx 3 &= \frac{x^2(1 + x)^2}{4} \\
            \Gx 4 &= \frac{x(x+1) (2x+1) \left(3x^2+3 x-1\right)}{30}
        \end{aligned}
    \end{equation}

    即：

    \begin{equation}
        1^4 + 2^4 + \cdots + n^4 = \sum_{i=1}^n i^4 = \frac{n(n+1) (2n+1) \left(3n^2+3 n-1\right)}{30}
    \end{equation}

    \paragraph*{附加题} 设$a_n$为拼成$1\times n$形地砖的方案数，$b_1$为拼成底为$n, n+1$的梯形地砖的方案数，特别地，$b_0$对应两种三角形地砖，拼接过程中的递推关系如下所示

    \begin{enumerate}
        \item 长为$1\times n$的地砖可以使用\textbf{(1)}$1\times (n-1)$的长方形地砖和$1\times 1$的正方形地砖拼成，也可以使用\textbf{(2)}底为$n-1, n$的梯形地砖和$1\times 1$的三角形地砖拼成；
        \item 底为$n, n+1$的梯形地砖，可以使用\textbf{(1)}$1\times n$的长方形地砖和$1\times 1$的三角形地砖拼成（有两种方向），也可以使用\textbf{(2)}底为$n-1, n$的梯形地砖和$\sqrt 2\times \sqrt 2$的三角形地砖拼成。
    \end{enumerate}

    由此，可以得到$a_n, b_n$满足的递推关系

    \begin{equation}
        \left\{
        \begin{aligned}
            a_n &= a_{n-1} + b_{n - 1} \\
            b_n &= 2a_{n} + b_{n - 1} \\
        \end{aligned}
        \right.
    \end{equation}

    联立两式，解得$a_n - 4a_{n-1} + a_{n-2} = 0$，根据题意，有$a_{0} = 1, a_{1} = 3, b_{0} = 2$。设序列$a_n$的母函数为$G(x)$，则$G(x)$满足

    \begin{derive}[G(x)]
        &= \frac{a_{0} + (a_{1} - 4a{0})x}{1 - 4x + x^2} \\
        &= \frac{1 - x}{1 - 4x + x^2} \\
        &= \frac{3-\sqrt 3}{6}\frac{1}{1 - (2-\sqrt{3})x} + \frac{3+\sqrt 3}{6}\frac{1}{1 - (2 + \sqrt 3)x}
    \end{derive}

    因此$a_n$的通项公式为

    \begin{equation}
        a_n = \frac{3 - \sqrt{3}}{6}(2-\sqrt{3})^n + \frac{3 + \sqrt{3}}{6}(2 + \sqrt{3})^n
    \end{equation}
\end{document}